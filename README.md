copied from: https://github.com/stites/CSSR
code slightly updated to avoid compilation errors, actual implementation unchanged
